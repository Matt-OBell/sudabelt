<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <record id="view_inventory_form_inherit" model="ir.ui.view">
        <field name="name">stock.inventory.form.inherit</field>
        <field name="model">stock.inventory</field>
        <field name="inherit_id" ref="stock.view_inventory_form"/>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='action_start']" position="after">
                <button name="action_inventory_manager_approve"
                        states="to approve"
                        string="Send for Approval"
                        type="object"
                        class="oe_highlight"
                        groups="stock.group_stock_user"/>

                <button name="action_approve"
                        states="awaiting_approval"
                        string="Approve"
                        type="object"
                        class="oe_highlight"
                        groups="ng_approvals.group_inventory_manager"/>
                <button name="%(action_stock_rejection)d"
                        states="awaiting_approval"
                        type="action"
                        string="Reject"
                        groups="ng_approvals.group_inventory_manager" />
            </xpath>
            <xpath expr="//button[@name='action_open_inventory_lines']" position="replace">
                <button name="action_open_inventory_lines"
                        string="Continue Inventory"
                        type="object"
                        class="oe_highlight"
                        attrs="{'invisible': [('state', 'not in', ['to approve', 'awaiting_approval'])]}"
                        groups="stock.group_stock_user"/>
            </xpath>
            <xpath expr="//field[@name='company_id']" position="after">
                <field name="rejected_by" attrs="{'invisible': [('reject_reason', '=', False)]}"/>
                <field name="reject_reason" attrs="{'invisible': [('reject_reason', '=', False)]}"/>
            </xpath>
        </field>
    </record>

    <record id="stock_inventory_line_tree2_inherit" model="ir.ui.view">
        <field name="name">stock.inventory.line.tree2.inherit</field>
        <field name="model">stock.inventory.line</field>
        <field name="inherit_id" ref="stock.stock_inventory_line_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='product_qty']" position="replace">
                <field name="product_qty" attrs="{'readonly': [('state', '!=', 'to approve')]}"
                       width="0.5" string="Counted"/>
            </xpath>
        </field>
    </record>
</odoo>
